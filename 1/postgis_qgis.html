<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Визуализация данных PostGIS в настольном ГИС приложении</title>

<topbar style="display:none;">
    <item><a href="../index.html">Домой</a></item>
    <item><a href="../intro.html">О курсе</a></item>
</topbar>

</head>
<body>
<xmp theme="simplex" style="display:none;">

Чтобы просмотреть, что из себя представляют загруженные в БД слои, откроем
их в настольном клиенте QGIS. Процесс установки QGIS в Windows описан в
статье [Установка QGIS/GRASS с помощью OSGeo4W](http://gis-lab.info/qa/qgis-osgeo4w.html).
Описание способов установки для различных ОС приведено [здесь](http://qgis.org/ru/site/forusers/download.html).

1. Запустите QGIS и в меню *Слой* выберите пункт *Добавить слой PostGIS*;
2. Нажмите кнопку *Создать* и в открывшемся окне введите параметры
   PostGIS-соединения:

   * **Имя** - произвольная строка по которой вы сможете идентифицировать
     данное PostGIS-соединение в списке доступных соединений;
   * **Узел** - адрес хоста на котором запущен PostgreSQL;
   * **Порт** - порт, который прослушивает PostgfeSQL (по умолчанию 5432);
   * **База данных** - `dbvega`;
   * **Пользователь** - `pguser`;
   * **Пароль** - `topsecret`;

   Отметьте пункты *Сохранить пользователя* и *Сохранить пароль* и нажмите OK:

   ![][01-qgis-01]

3. В открывшемся окне нажмите кнопку *Подключиться*, после чего вы увидите
   список слоёв PostGIS, доступных на сервере.

   ![][01-qgis-02]

4. Отметьте слои, которые вы желаете отобразить и нажмите кнопку *Добавить*.
   Примерно так (с настроенной символикой) будут выглядеть слои `water_polygon`
   и `building_polygon`:

   ![][01-qgis-03]

Отображение PostGIS-слоёв, построенных на базе произвольных запросов
--------------------------------------------------------------------

Запустите расширение `DB Manager` через меню `Database` и выберите базу
данных `vega`, после чего нажмите на кнопку *SQL window*.
Необходимо чтобы результат SQL-запроса содержал как минимум 2 поля:
поле первичного ключа и поле геометрии.

Выполним следующий запрос:

    SELECT ogc_fid, ST_Buffer(ST_Transform(wkb_geometry, 3857), 5) geom, name FROM building_polygon LIMIT 100;

В результате чего будет запрошено 100 геометрий, перепроецированных
в новую проекцию и с построенным пятиметровым буфером. Операции по
перепроецированию и построению буфера выполняются на стороне сервера.
Активируйте чекбокс `Load as new layer` и укажите поле первичного
ключа и геометрии, после чего нажмите `Load now!`.

![][01-qgis-05]

Если поверх этого слоя отобразить оригинальные геометрии (включив
в QGIS преобразование координат *на лету* в проекцию 3857), то это
будет выглядеть следующим образом:

![][01-qgis-06]

[01-qgis-01]: ../img/01-qgis-01.png
[01-qgis-02]: ../img/01-qgis-02.png
[01-qgis-03]: ../img/01-qgis-03.png
[01-qgis-04]: ../img/01-qgis-04.png
[01-qgis-05]: ../img/01-qgis-05.png
[01-qgis-06]: ../img/01-qgis-06.png

</xmp>
<script src="../strapdown/v/0.2/strapdown.js"></script>
<script src="../strapdown-topbar/assets/strapdown/strapdown-topbar.min.js"></script>
<script src="../strapdown-topbar/assets/logo.js"></script>
<script src="../footer.js"></script>
</body>
</html>
