<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Установка PostGIS в Debian GNU/Linux 8.0</title>

<topbar style="display:none;">
    <item><a href="../index.html">Домой</a></item>
    <item><a href="../intro.html">О курсе</a></item>
</topbar>

</head>
<body>
<xmp theme="simplex" style="display:none;">
Установка PostGIS
-----------------

![][01-postgis-08]

В Debian GNU/Linux 8.0 в репозиториях доступен PostGIS 2.1.3, однако, версия может измениться.
Для того, чтобы узнать имя пакета, который нужно установить, выполните команду:

    sudo apt-cache search postgis

В полученном списке найдите пакет, имя которого имеет вид **postgresql-{version}-postgis-{version}**
и установите его:

    sudo aptitude install postgresql-9.3-postgis-2.1


Добавление функций PostGIS в базу данных
----------------------------------------

Чтобы внутри базы данных были доступны функции PostGIS, их необходимо туда
загрузить. Делаем это от имени пользователя `postgres` (у пользователя
`pguser` на выполнение данных инструкций недостаточно прав):

    sudo su - postgres -c "psql -d dbvega -f /usr/share/postgresql/9.3/contrib/postgis-2.1/postgis.sql"
    sudo su - postgres -c "psql -d dbvega -f /usr/share/postgresql/9.3/contrib/postgis-2.1/spatial_ref_sys.sql"

Начиная с версии Postgres 9.1 PostGIS может быть установлен с помощью механизма **CREATE EXTENSION**:

    sudo su - postgres -c "psql -d dbvega -c 'CREATE EXTENSION postgis;'"

Сделаем пользователя владельцем служебных таблиц, созданных при установке PostGIS:

    sudo su - postgres -c "psql -d dbvega -c 'ALTER TABLE geometry_columns OWNER TO pguser'"
    sudo su - postgres -c "psql -d dbvega -c 'ALTER TABLE spatial_ref_sys OWNER TO pguser'"
    sudo su - postgres -c "psql -d dbvega -c 'ALTER TABLE geography_columns OWNER TO pguser'"

Чтобы проверить, что PostGIS установился, выполним команду c локального хоста:

    psql -d dbvega -U pguser -c "SELECT PostGIS_Full_Version();"

или с удалённого:

    psql -d dbvega -h 10.22.0.9 -U pguser -c "SELECT PostGIS_Full_Version();"

В результате чего должен быть получен ответ вида:

    POSTGIS="2.1.3 r12547" GEOS="3.4.2-CAPI-1.8.2 r3921" PROJ="Rel. 4.8.0, 6 March 2012" GDAL="GDAL 1.10.1, released 2013/08/26" LIBXML="2.9.1" LIBJSON="UNKNOWN" RASTER
    (1 строка)

[01-postgis-08]: ../img/01-postgis-08.png

</xmp>

<script src="../strapdown/v/0.2/strapdown.js"></script>
<script src="../strapdown-topbar/assets/strapdown/strapdown-topbar.min.js"></script>
<script src="../strapdown-topbar/assets/logo.js"></script>
<script src="../footer.js"></script>
</body>
</html>
